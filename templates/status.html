<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Records Queue</title>
    <style>
      #results {
        max-height: 400px;
        overflow: scroll;
      }

      h1 {
        margin-bottom: 0;
      }

    </style>
</head>

<script type="text/javascript">
    document.addEventListener("DOMContentLoaded", function() {
      // Server-Side Events
      var resultdiv = document.getElementById("results");
        var eventSource = new EventSource("{{ url_for('stream') }}");
        eventSource.onmessage = function(e) {
          resultdiv.innerHTML = e.data + "\n<br>\n" + resultdiv.innerHTML;
        };
        eventSource.onerror = function(e) {
          eventSource.close();
        };
    });
</script>

<body id="body">
    <h1>Prime Gap Records Queue</h1>
    <div>
      Worker Status:
      {% if running %}
        <span style="color:green">Alive</span>
      {% else %}
        <span style="color:red">
          Dead (ping the
          <a href="https://www.mersenneforum.org/showthread.php?t=25313">thread</a>
          please)
        </span>
      {% endif %}
    </div>

    <div id="records">
    {% if new_records %}
      <h2>New Records</h2>
    {% for r in new_records %}
      <div>{{ r }}</div>
    {% endfor %}
    {% endif %}
    </div>

    <div id="recent">
    {% if recent %}
      <h2>Recent records checked</h2>
    {% for r in recent %}
      <div>{{ r }}</div>
    {% endfor %}
    {% endif %}
    </div>

    <div id="queue">
      <h2>{{queued}} Queued</h2>
    {% for line in queue %}
      <div>{{ line }}</div>
    {% endfor %}
    </div>

    <hr>
    <h2>Status</h2>
    <div id="results">{{status}}</div>
    <hr>
</body>
</html>
